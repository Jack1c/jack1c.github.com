---
layout: post
title: lose function
toc: true
cover: /img/cover/why-is-binary.png
tags: ['cs231n']
category: Java
---

### 损失函数(loss function)

![](media/15323709004978.jpg)

如何选择$W$的值, 如何训练数据来得到$W$的最优取值? 
对应W的某个值时,使用W得到任意图片的10个分类的得分, 有些分类的得分高,有的低.

上图所示,有三个分类的图片然后用某个W预测图片的所有10类别的得分,从图中的数据可以看出有些分类的分数高,有些的分数低.比如左上角的图片是一只猫,人类很容易分辨出来, 此时权重$W$给出这张图片属于猫的得分是2.9, 然而给出属于青蛙分类的得分是3.78.此时这个分类器对于这张图片没有效果,猫应该得分应该是最高的. 对于其他的图片,比如第二张图片汽车得分为6.04,比其他的类别都要高, 这样的权重$W$很好. 第三张图片中 青蛙的得分是-4.34 比其他的类型都要小,此时分类器表现很糟糕.

这种手动的方式,通过看一眼每个分类的分数哪些是好的,哪些是坏的, 如果要写一个程序自动决定哪些$W$是最优的,就需要一个能度量任意$W$的好坏的方法. 

**可以有用一个函数把$W$作为输入,然后查看一下得分, 定量的估计权重$W$的好坏,这个函数称为损失函数(loss function)**

---

有了损失函数的定义,我们可以定量的衡量一个任意的权重$W$的好坏, 需要找到一种有效的方式能从权重$W$的可行域里找到$W$的取值使得权重$W$在分类中表现最好,这个过程是一个优化的过程. 

![](media/15323708448496.jpg)


由于10个类不太方便,所以把这个例子缩小一下取值范围. 看看在三个样本对应三个类的例子中看看是怎样具体操作的.在这个例子中 猫目前的分类是不对的,汽车的分类是正确的, 青蛙的分类彻底错误.

训练数据通常有N个样本,其中的$X$和$y$:

+ $X$ 是在图片分类问题里的图片像素点所构成的数据集
+ $y$ 算法预测出来的,通常称为label或者targets

在图片分类的例子中, 尝试把 CIFAR-10 数据集中的每个图片从10中分类里面分出一个种类,
所有label是一个在1到10之间的整数.

将损失函数记做: $L_{i}$, 定量的描述通过函数f给出的预测分数和真实的目标或者label的差距.
最终损失函数L是整个数据中N个样本损失函数的总和的平均值. 在所有的$W$找出在训练集上损失最小时候的权重$W$. 

$损失函数: L = \frac{1}{N}{\sum_{i}L_{i}(f(x_i,W),y_i)}$
--
### 多分类SVM损失函数
多分类SVM损失函数(multi-class SVM loss),作为第一个具体的损失函数的例子,同时能将这个例子和图片分类很合适的结合起来.

在支持向量机中可能见过 二元SVM(binary SVM),多类别SVM是在处理多分类的一种泛化.在二元SVM中,只有两中分类,每个样本x,要么被分为正,要么被分为负. 现在有10种类别,要将这个概念扩展到多分类中来来. 

损失函数$L_i$的计算方式: 

+ 除了正式分类 $y_i$ 以外的所有的分类都求和,也就是将所有的错误分类做求和运算. 
![-w267](media/15324472661136.jpg)



 





